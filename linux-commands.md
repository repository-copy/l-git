#Конспект команд Linux из курса https://ru.hexlet.io/courses/bash/lessons/traverse/theory_unit

Если быть до конца точными, то философия *nix систем это "все есть файл". То есть папка это тоже файл, а так же файлом является любое устройство. Выражается это на программном уровне в том, что мы можем работать с любой сущностью как с файлом. То есть писать в нее или читать через унифицированный интерфейс, read и write.

pwd 
  print working directory

ls
  список папок и файлов
  ls --help, map ls - список флагов, описание, помощь.

  ls -all           показать все файлы и папку, включая скрытые
  ls -sh filename   показать размер файла в удобочитаемом формате
  ls -l filename    посмотреть права на файл


~ 
  ~/ относительный путь начинается с домашней директории


mkdir 
  create directory
  mkdir -p test/test3    создание директорий рекурсивно. т.е создаст test и внутри test3

touch -
  создать файл

tree 
  посмотреть дерево файлов и папок
  tree dir - дерево папок и файлов внутри папки dir
  Программа tree по умолчанию отсутствует в большинстве операционных систем. Ее необходимо устанавливать отдельно.
  tree -a -L 2 -I node_modules (вывести все файлы включая скрытые, глубина вложений 2, игнорировать node_modules

mv 
  перемещение (переименование) папок и файлов
  mv oldName newName - переименовать папку
  mv dir/* targetDir - переместить всё содержимое папки dir в папку targetDir

rm 
  удалить файл
  для удаления директории нужно использовать флаг -r (рекурсивное удаление) rm -r dir
  rm -r * внутри директории удалить всё содержимое директории.
  rm -r dir/* удалить всё внутри директории dir

cp 
  копирование 
  cp file /dir    копировать file в дирикторию dir

  cp -r dir1 /dir2   копировать директорию в другую директорию

  cp -r dir1/. /dir2 копировать все содержимое (включая скрытые файлы) dir1 в dir2

  cp -r dir1/* /dir2 копировать все, но без скрытых файлов и папок.


cat 
  вывести содержимое файла в консоль

head 
  вывести первые десять строк из файла

tail
  вывести последние десять строк из файла
  tail -f будет выводить строки при каждом изменении файла (Ctrl - C) для выхода из этого режима

grep
  поиск подстроки (а вообще очень навороченная команда и с помощью неё можно сделать множество вещей)
  grep str file - поиск строки str в файле file

less 
  для открытия больших файлов и удобной навигации по ним
  Команды внутри режима less
  h - получить справку
  Shift-G - перейти в конец файла
  G - перейти в начало файла
  для поиска набрать /слово
  N - перейти к следующему найденному слову
  n - перейти к предыдущему найденному слову

man 
  программа которая показывает страницу документации для конкретной программи. Почти все консольные программы в linux имеют man (Я так думаю man это от manual). 
  Примеры использования:
  man mkdir
  man less
  man ls
  man man :) Даже у man есть man

  man -f programNam Флаг -f означает поиск программы во всех категориях (в программах оболочки и в системных вызовах. Как-то так. Надо еще поднобнее почитать об этом)

  man 2 programName - 2 это номер категории, который мы посмотрели вызовом man -f programName. Для системного вызова описание будет другим. 

reset 
  очистить консоль
clear
  тоже очистить. В чем разница пока не знаю.

gio trash <filename> - удаление в корзину

du -bsh * - в текущей папке показывает размер файлов


============================= **Резервное копирование** ================
Список установленных пакетов полученный командой dpkg --get-selections | grep -v deinstall > backup.txt
ну и может что-то еще.

Когда система сломается, переустановите ее с установочного носителя, а затем просто выполните команды:

sudo dpkg --set-selections < backup.txt

sudo apt-get -y update
sudo apt-get dselect-upgrade




============================== **Переменные окружения** ================
which 
  показывает путь к программе.

env
  команда показывает список переменных окружения установленных в текущей сессии 

export MYVAR=10 
  экспорт переменной в список переменных окружения для текущей сессии. 

PATH=/var/tmp:$PATH - Этой командой мы добавляем в переменную PATN путь /var/tmp в рамках текущей сессии.

unset VARNAME - удаляет переменную из окружения в рамках текущей сессии.





=================== **Перенаправления и потоки** ============================
STDOUT - стандартный поток вывода. BASH так работает, что по умолчанию выводит всё на экран (в консоль свою).

Можно это менять с помощью символа > 
Например:
  ls > output - при такой команде будет создан файл output и в него записан вывод программы ls
  echo "my string" > test - вывод echo будет перенаправлен в файл test

STDIN - стандартный поток ввода
Знаком < можно заменять стандартный поток ввода. Например какой-нибудь программе на ввод отправить какой-нибудь файл.
  
  sort < myFile  Такая команда запускает программу sort и на вход передает ей файл myFile

  Можно комбинировать. Например:
  sort < myFile > newFile  Тут мы сначала передаем на вход программе sort файл myFile а результат перенаправляем в файл. 


| Конвеер
Передача из программы в программу. Результат одной программы можно передать на вход другой программе. Называется это конвеер и делается с помощью символа вертикльной черты "|" Например:
  cat anyFile | sort В этом примере вывод программы cat происходит не в консоль, а передается на вход команде sort

  Частый вариант использования конвеера с программой grep, когда нам нужно в каком-то файле найти только часть данных
  ls | grep test | grep rtk  (test и rtk это строки для поиска) Такой командой мы ищем файлы в названии, которых есть подстрока rtk 

wc 
  word count  фильтр который показывает кол-во строк, слов и букв
  ls | wc       вывод программы ls направляем в программу wc и она нам посчитает колв сток, слов и букв.
  wc < anyFile      на вход программе wc отправляем файл






=================== **История** ===================
История команд сохраняется в файле домашней директории под названием .bash_history посмотреть её можно так:
cat ~/.bash_history

history
  выводит пронумерованную историю команд. 

!comandNumber 
  запуск команды из истории по номеру. Например: !123, !34 и т.д. любой номер, который есть в истории команд. И эта комадна выполнится. 

!!
  запуск последней команды

!comandName
  поиск и выполнения первой найденной команды с конца истории, которая соответсвует введенному слову. 

Ctr-r 
  инкриментальный поиск по всей истории команд.
  После нажатия Ctr-r появится что-то вроде (reverse-i-search): и можно вводить строку, будут предлагаться варианты команд из истории содержащие эту строку. Если команд было много, то можно их перебирать с помощью этого же Ctr-r.




======================= **Псевдонимы (Алиасы)** ==============================
Псевдонимы (Aliases) это шорткаты для команд с часто используемыми аргументами.

alias 
  показывает список всех алиасов установленных в системе.

alias l="ls -CF"
  cоздает алиас для вызова команды ls с аргументом -CF Т.е. при наборе l будет выполняться команда ls -CF

type l
  посмотреть содержание алиаса

unalias l 
  удаляет алиас l

ll -S сортировать по размеру

====================== **Администрирование пользователей и Групп** ==================================

gpasswd -d testuser groupname - удалить юзера из группы

usermod -a -G grouname username - добавить пользователя в группу

useradd -m -g users -G adm,cdrom -p password -s /bin/bash test2
    Создание пользователя с группой по умолчанию users (причем группа users уже должна существовать)
    Подробности:
        -m              создать папку в /home с именем юзера. В нашем случае это будет /home/test2
        -g users        назначить группу по умолчанию и добавить юзера в эту группу (вместо создания группы с его именем). Важно: группа уже должна существовать.
        -G adm,cdrom    добавить юзера в группы
        -p password     назначить пароль
        -s /bin/bash    The name of user's shell.

passwd username - изменить пароль пользователя

grep ^admin /etc/group - список всех пользователей группы admin

id username -Gn - список всех групп пользователя


================== **Nginx** =====================

service nginx start | stop | reload


================== VirtualBox ================

vboxmanage startvm debian --type headless       - стартует установленную ОС без графического интерфейса "debian" - здесь это имя гостевой ОС, которую мы стартуем
vboxmanage controlvm debian acpipowerbutton     - останавить виртуальную машину



===============**Разные команды из разных мест**==========================

Убить процесс pkill <имя процесса> другие способы https://losst.ru/kak-ubit-protsess-linux
file /path/to/your/file - показыает информацию о типе файла
file -l        - покажет список всех доступных файлов в линукс
inxi -F     Хорошо и подробно выводит информацию о системе

w - Show who is logged on and what they are doing.
pkill -KILL -t tty   - разлогинить пользователя (tty это идентификатор консоли под которой работает пользователь, посмотреть его можно командо w )

ncdu - Это консольная утилита с псевдографическим интерфейсом. Показывает размер файлов и папок и прямо из неё можно удалять клавишей d 


================ **Команды связанные с компилятором C C++** ===================

Вопрос: А как библиотеку cs50.h подключить? (cs50.h это мини-учебная библиотека курса cs50.h) Причем, в примере ниже идет речь о версии 2015 года, в 2020 они её изменили.

sudo su -
apt-get install gcc
wget http://mirror.cs50.net/library50/c/library50-c-5.zip
unzip library50-c-5.zip
rm -f library50-c-5.zip
cd library50-c-5
gcc -c -ggdb -std=c99 cs50.c -o cs50.o
ar rcs libcs50.a cs50.o
chmod 0644 cs50.h libcs50.a
mkdir -p /usr/local/include
chmod 0755 /usr/local/include
mv -f cs50.h /usr/local/include
mkdir -p /usr/local/lib
chmod 0755 /usr/local/lib
mv -f libcs50.a /usr/local/lib
cd ..; rm -rf library50-c-5





